define(["../../../audio","require","../../../scenes"],function(b,a){var c=55;var e=30;var d=10;var f=15;return{createComponent:function(){Crafty.c("Damage",{damage:function(g){switch(g){case"lava":if(this._shield>0){this._shield=this._shield-2}else{this._health--}break;case"enemy":if(this._shield>0){this._shield=this._shield-Math.floor(Math.random()*(c-e+1)+e)}else{this._health=this._health-Math.floor(Math.random()*(d-f+1)+f)}break}if(this._shield<=0){this._shield=0;$("#lifebar").css({width:(this._health*3)+"px",background:"rgb(50,200,50)"});$("#vidatext").html("Vida:");this.removeBonus("shield")}if(this._shield>0){if(g=="lava"){if(this._shield%20===0){b.playShield()}}else{b.playShield()}$("#lifebar").css({width:(this._shield*3)+"px"})}else{if(this._health>0){if(g=="lava"){if(this._health%10===0){b.playDamage()}}else{b.playDamage()}$("#lifebar").css({width:(this._health*3)+"px"})}else{this.die(g)}}},die:function(g){Scenes=a("../../../scenes");b.playCharDeath();this._health=0;b.stopLevel();b.stopAlert();b.stopHidden();if(g==="lava"){this.clearLava()}if(g==="enemy"){this.clearBattle()}if($(".battle").length>0){$(".battle").remove()}if(Crafty("Multiplayer").length>0){this.restartMultiFlags()}Crafty("obj").each(function(){this.destroy()});Scenes.restartLevel()},init:function(){this.requires("Lava, Battle")}})}}});