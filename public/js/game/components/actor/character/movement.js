define(["../../../constants"],function(a){var b=7;return{createComponent:function(){Crafty.c("Movement",{_posy:undefined,jump:function(){var g;var f=false;var h=this.pos();h._y=h._y-b;h.x=h._x;h.y=h._y;h.w=h._w;h.h=h._h;var e=Crafty.map.search(h);var c=e.length;for(var d=0;d<c;++d){g=e[d];if(g!==this&&g.has(this._anti)&&g.intersect(h)){f=g;break}}if(f){this.y=f._y+this._h}else{if(this._up){this.clearLava();this.y-=b;this._falling=true;if(this._orientation==="right"){this.pauseAnimation();this.sprite(1,4)}else{this.pauseAnimation();this.sprite(1,3)}this.trigger("Moved",{x:this._x,y:this._y+b})}}},init:function(){this.requires("Lava");this.gravity("Terrain").gravityConst(0.3);this.multiway(3,{RIGHT_ARROW:0,LEFT_ARROW:180});this.bind("EnterFrame",function(){this.jump();if(!this._up&&!this._falling&&!this.isPlaying("CharMoveRight")&&!this.isPlaying("CharMoveLeft")){this.pauseAnimation();if(this._orientation=="left"){this.sprite(1,0)}else{this.sprite(0,0)}}});this.bind("KeyDown",function(){if(!this._falling&&this.isDown("UP_ARROW")){this._up=true}else{if(this.isDown("RIGHT_ARROW")){this._orientation="right";if(!this._up&&!this._falling&&!this.isPlaying("CharMoveRight")){this.animate("CharMoveRight",-1)}}else{if(this.isDown("LEFT_ARROW")){this._orientation="left";if(!this._up&&!this._falling&&!this.isPlaying("CharMoveLeft")){this.animate("CharMoveLeft",-1)}}}}});this.bind("KeyUp",function(c){if(c.key===Crafty.keys.LEFT_ARROW){this.pauseAnimation();this.sprite(1,0)}else{if(c.key===Crafty.keys.RIGHT_ARROW){this.pauseAnimation();this.sprite(0,0)}}});this.bind("Moved",function(c){if(this.hit("Terrain")){this.x=c.x}if(this.x<=0||this.x>=a.getLevelSize("px").width){this.x=c.x}if(c.x<this.x){this._orientation="right";if(!this._up&&!this._falling&&!this.isPlaying("CharMoveRight")){this.animate("CharMoveRight",-1)}}else{if(c.x>this.x){this._orientation="left";if(!this._up&&!this._falling&&!this.isPlaying("CharMoveLeft")){this.animate("CharMoveLeft",-1)}}}})}})}}});